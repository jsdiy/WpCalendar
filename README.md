# WpCalendar
Windowsの壁紙に直接描画する非常駐型カレンダーアプリ。

# 特徴
- 壁紙にカレンダーを描画する非常駐型アプリです。
- 表示位置、大きさ、色のほか、カスタマイズの自由度が高いです。
- 誕生日などを特別日として登録し、専用色を割り当てることができます。

# 開発環境
- Windows11 Pro / 25H2, 日本語
- .NET Framework 4.8

# インストール／アンインストール
インストール作業はありません。レジストリは使用しません。  
アンインストールはWpCalendar.exeと、下記場所の設定ファイルwpcalendar.settingを削除してください（RKSoftwareフォルダごと削除）。
- C:\Users\\{ユーザー名}\AppData\Local\RKSoftware\WpCalendar

# 自動起動の設定方法
タスクスケジューラーに下記2通りのトリガーで登録するのがお勧めです。この場合「-once」オプション付きで起動してください。
設定の詳細は[taskschedulerフォルダ](https://github.com/jsdiy/WpCalendar/tree/main/taskscheduler)をご確認ください。
- 毎日0時に更新する
- ログイン時に更新する

# 描画内容の設定方法
1. アプリを起動し、項目を設定し、[カレンダーを描画する]ボタンを押します。
1. 描画の様子を確認し、アプリを終了してください。

![画面参考](https://github.com/jsdiy/WpCalendar/blob/main/sample/setting_v140.png)
以下、設定タブごとの説明です。※上記はVer. 1.40の画面。

## 描画内容
- 月の切り替え  
月ごとのカレンダーを毎月1日に切り替えるか15日に切り替えるかを選びます。  
[15日目]は、[2カ月],[3カ月]表示で[今月-来月-…]を設定しているときに意味を持ちます。
[1日目]に設定すると毎月1日に前月の表示が消えますが、月が変わっても前月の様子を1,2週間は見られるようにしておきたいというとき、
[15日目]に設定すると当月14日までは前月の表示が残るようになります。

## 書式
- 年/月  
＜記号＞＜例＞を参考に、[書式]欄に自由に書式を記述し、[表示確認]ボタンを押して描画内容を確認します。

## 色/フォント
- フォント  
それぞれボタンを押し、フォントダイアログから設定します。
目が疲れないよう、見やすく馴染みのあるものを選択する方が無難です。

## 特別日
- 登録  
登録できる日数に制限はありません。  
「毎週xx曜」と設定したい場合、[曜日で指定]で「第1xx曜」～「第5xx曜」と1週分ごとに入力してください。

- 登録済み一覧  
日にちを選択し、[削除]ボタンを押します。複数同時選択できます。

## 高度な設定
「日にち」に限り描画状態を調整することができます。  
[色/フォント]タブでクセのあるフォントを設定すると、カレンダーとして実用にならない描画となることがあります。
例えば「Bickham Script Pro」はグリフ（文字の形として見える部分）に対して周囲の余白がかなり大きく、字間を相当詰める必要がありますが、
[今日の背景]で表示される丸や四角は余白を含む元の大きさのままなので、ちぐはぐな描画となってしまいます。  
[高度な設定]は、それをどうにか使える状態に近付けようという機能です。

- マスの大きさ  
このアプリで「日にち」は見えないマスの中に描かれています。
[色/フォント]タブ - [効果の色/太さ] - [今日の背景] - [四角形 塗り]を選択したときの四角い領域です。
このマスの[幅][高さ]を調整します。  
なお、[今日の背景]の丸は「日にち」のマスの短辺を直径として描画されます。

- 文字の位置  
日にちの文字が重ねて描画されています。それがマス内に収まるよう、[水平][垂直]位置を調整します。

[確認]ボタンで表示確認と調整を繰り返し、最後に[カレンダーを描画する]ボタンで壁紙に描画してください。

## オプション
- その他  
[カレンダーを消去する]ボタンを押すと、カレンダーが表示されていない元の壁紙に戻ります。

グレーアウトしている部分は無視してください。
タスクスケジューラーに登録する方式に変更したので、Ver. 2.00で廃止した機能です。
